# Story 6.4: Revision Bundle - Short Video Generation

**Epic:** 6 - Progress Tracking & Personalization
**Story Number:** 6.4
**Status:** Draft
**Created:** December 23, 2025
**Sprint:** Sprint 7 (Epic 6)
**Estimated Effort:** Large (L)
**Risk Level:** MEDIUM

---

## Story

**As a** UPSC aspirant,
**I want** each weak topic to have an automatically generated 3-5 minute revision video,
**so that** I can quickly review key concepts without re-watching full lectures.

---

## Acceptance Criteria

1. Video generation: for each revision target, generate 3-5 min video covering key points
2. Script generation: Edge Function calls A4F LLM with prompt "Create revision summary for {topic} in 400-500 words focusing on most-tested concepts"
3. RAG integration: retrieves top 3 most relevant chunks from knowledge base for the topic
4. Visual markers: script includes [DIAGRAM], [TIMELINE], [MAP] markers for Manim scenes
5. Manim scenes: generates 1-2 simple diagrams per video (flowcharts, timelines, concept maps)
6. Revideo assembly: combines TTS narration, Manim scenes, transitions into final video
7. Video storage: saves to Supabase Storage at `revision-videos/{user_id}/{topic_id}_revision.mp4`
8. Database: `revision_videos` table with user_id, topic_id, video_url, duration, created_at
9. Rendering queue: uses job queue system to avoid overload (max 5 concurrent renders)
10. Fallback: if video generation fails, displays text notes with "Video coming soon" message

---

## Dependencies

**Blocking:** Stories 6.3, 0.5, 0.6 (weak topics identified, Manim/Revideo services)
**Blocks:** Story 6.5

---

## Definition of Done

- [ ] All AC met
- [ ] Videos generated correctly
- [ ] Manim scenes integrated
- [ ] Videos stored securely
- [ ] Tests passing

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-23 | 1.0 | Initial story creation | Bob (SM Agent) |
