# Story 1.1: Project Setup & Development Environment

**Epic:** 1 - Foundation & RAG Knowledge Infrastructure
**Story Number:** 1.1
**Status:** Complete
**Created:** December 23, 2025
**Sprint:** Sprint 2 (Epic 1 - Foundation)
**Estimated Effort:** Large (L)
**Risk Level:** HIGH (Foundation for all development)

---

## Story

**As a** developer,
**I want** a fully configured monorepo with Next.js frontend, Supabase backend, CI/CD pipeline, and local development environment,
**so that** the team can begin feature development with standardized tooling and automated quality checks.

---

## Scope

**INCLUDED:**
- Turborepo monorepo structure with apps and packages
- Next.js 14+ App Router configuration
- TypeScript, Tailwind CSS, ESLint, Prettier setup
- GitHub repository with branch protection
- CI/CD pipeline with automated checks
- Local development documentation
- Environment variables template
- Health check API endpoint

**NOT INCLUDED (Non-Scope):**
- Database schema implementation (Story 1.2, 1.3)
- Authentication system (Story 1.2)
- Any feature implementation
- Deployment to production
- Content or assets

---

## Acceptance Criteria

1. Turborepo monorepo initialized with `apps/web`, `apps/admin`, `packages/supabase`, `packages/ui`, `packages/config`, `packages/utils` structure
2. Next.js 14+ (App Router) configured in `apps/web` with TypeScript, Tailwind CSS, ESLint, Prettier
3. Supabase project created (cloud or self-hosted) with connection pooling enabled
4. GitHub repository initialized with branch protection rules (require PR approval, passing CI checks)
5. GitHub Actions CI/CD pipeline configured running on every PR: `lint`, `type-check`, `test`, `build`
6. Local development setup documented in `README.md` with commands: `pnpm install`, `pnpm dev`, `pnpm test`
7. Environment variables template (`.env.example`) created listing all required keys (SUPABASE_URL, SUPABASE_ANON_KEY, etc.)
8. Simple health-check route deployed: `GET /api/health` returns `{ status: "ok", timestamp: ISO8601 }`

---

## Dependencies

**Blocking Dependencies (Must Complete First):**
- ✅ Epic 0 fully complete (all 14 stories)
- ✅ Story 0.11: Full Stack Local Development (provides baseline setup)
- ✅ Story 0.12: Git Repository & CI/CD Pipeline (provides templates)
- ✅ Story 0.13: Environment Variables & Secrets Management

**Blocks These Stories:**
- Story 1.2: Authentication System (needs monorepo structure)
- Story 1.3: Database Schema - Core Tables (needs Supabase project)
- ALL remaining Epic 1+ stories (foundation for entire project)

---

## Tasks / Subtasks

- [x] **Task 1: Initialize Turborepo Monorepo** (AC: 1)
  - [x] Run `npx create-turbo@latest` and select pnpm
  - [x] Create folder structure: `apps/`, `packages/`, `docs/`
  - [x] Configure `turbo.json` with pipeline tasks (dev, build, lint, test)
  - [x] Create `pnpm-workspace.yaml` listing all packages
  - [x] Verify `pnpm install` resolves all dependencies

- [x] **Task 2: Configure Next.js Web App** (AC: 2)
  - [x] Create `apps/web` with `npx create-next-app@latest` (TypeScript, App Router, Tailwind)
  - [x] Configure `next.config.js` with Turborepo settings
  - [x] Set up Tailwind CSS with custom Neon Glass theme from `docs/ux-spec.md`
  - [x] Configure TypeScript with strict mode (`tsconfig.json`)
  - [x] Add ESLint and Prettier configs from `packages/config`
  - [x] Create basic layout: `app/layout.tsx` with metadata
  - [x] Create landing page: `app/page.tsx` with "UPSC PrepX-AI" title
  - [x] Verify `pnpm dev` starts dev server on port 3000

- [x] **Task 3: Create Next.js Admin App** (AC: 1)
  - [x] Create `apps/admin` similar to `apps/web`
  - [x] Configure separate port (3001) in `package.json`
  - [x] Create admin layout with "Admin Dashboard" header
  - [x] Add auth middleware (placeholder for now)
  - [x] Verify `pnpm dev` starts both apps simultaneously

- [x] **Task 4: Create Shared Packages** (AC: 1)
  - [x] Create `packages/ui` with shadcn/ui setup
  - [x] Create `packages/config` with shared ESLint, Tailwind, TypeScript configs
  - [x] Create `packages/utils` with helper functions
  - [x] Create `packages/supabase` with migrations folder structure
  - [x] Configure package.json exports for each package
  - [x] Add internal dependencies in Turborepo config

- [x] **Task 5: Initialize Supabase Project** (AC: 3)
  - [x] Create Supabase project via dashboard or CLI
  - [x] Enable connection pooling in project settings
  - [x] Note project URL and API keys (ANON, SERVICE_ROLE)
  - [x] Initialize Supabase CLI in `packages/supabase`
  - [x] Link local project: `supabase link --project-ref <ref>`
  - [x] Create initial migration folder structure
  - [x] Test connection from local: `supabase db ping`

- [x] **Task 6: Initialize GitHub Repository** (AC: 4)
  - [x] Create GitHub repository: `upsc-ai-mentor`
  - [x] Push initial commit with monorepo structure
  - [x] Configure branch protection on `main`: require PR, status checks
  - [x] Add `.gitignore` excluding `node_modules`, `.env.local`, `dist`
  - [x] Create `CODEOWNERS` file for review assignments
  - [x] Add repository description and tags

- [x] **Task 7: Configure CI/CD Pipeline** (AC: 5)
  - [x] Create `.github/workflows/ci.yml` from Story 0.12 template
  - [x] Add jobs: `install`, `lint`, `type-check`, `test`, `build`
  - [x] Configure pnpm caching for faster CI runs
  - [x] Add GitHub secrets: `SUPABASE_URL`, `SUPABASE_ANON_KEY`
  - [x] Test pipeline: push commit, verify all checks pass
  - [x] Add status badge to README.md

- [x] **Task 8: Create Environment Variables Template** (AC: 7)
  - [x] Create `.env.example` in project root
  - [x] List all required variables from `docs/infrastructure-reference.md`
  - [x] Add comments explaining each variable
  - [x] Create `.env.local` (git-ignored) with actual values
  - [x] Document env var setup in README.md
  - [x] Test that apps start with env vars loaded

- [x] **Task 9: Create Health Check API Route** (AC: 8)
  - [x] Create `apps/web/app/api/health/route.ts`
  - [x] Implement GET handler returning JSON: `{ status: "ok", timestamp, version }`
  - [x] Add uptime calculation (process.uptime())
  - [x] Test endpoint: `curl http://localhost:3000/api/health`
  - [x] Add CORS headers if needed
  - [x] Document health check in API documentation

- [x] **Task 10: Create Project Documentation** (AC: 6)
  - [x] Create comprehensive `README.md` with:
    - Project overview
    - Prerequisites (Node 20+, pnpm 8+)
    - Installation steps: `pnpm install`
    - Development commands: `pnpm dev`, `pnpm build`, `pnpm test`
    - Project structure explanation
    - Contributing guidelines
  - [x] Create `CONTRIBUTING.md` with PR process
  - [x] Create `docs/development-guide.md` with detailed setup
  - [x] Add troubleshooting section for common issues

- [x] **Task 11: Verify Complete Setup** (AC: All)
  - [x] Run `pnpm install` on clean clone
  - [x] Run `pnpm dev` - verify web (3000) and admin (3001) start
  - [x] Run `pnpm lint` - verify no errors
  - [x] Run `pnpm type-check` - verify TypeScript passes
  - [x] Run `pnpm build` - verify production build succeeds
  - [x] Push to GitHub - verify CI pipeline passes
  - [x] Test health check endpoint returns 200 OK

---

## Dev Notes

### Relevant Architecture Information

**Source Tree Reference:** [Source: docs/architecture/source-tree.md]

Complete monorepo structure documented with:
- Turborepo configuration
- Apps organization (web, admin)
- Packages organization (supabase, ui, config, utils)
- Import conventions and absolute paths
- Build commands and scripts

**Tech Stack Reference:** [Source: docs/architecture/tech-stack.md]

- **Monorepo Tool:** Turborepo v2.x
- **Package Manager:** pnpm 8+
- **Frontend Framework:** Next.js 14.2+ (App Router)
- **Frontend Language:** TypeScript 5.3+
- **UI Library:** shadcn/ui (Radix UI primitives)
- **CSS Framework:** Tailwind CSS 3.4+
- **Build Tool:** Turbopack (built into Next.js)
- **CI/CD:** GitHub Actions
- **Backend:** Supabase (PostgreSQL + Edge Functions)

**Coding Standards Reference:** [Source: docs/architecture/coding-standards.md]

- TypeScript strict mode enabled
- ESLint + Prettier for code formatting
- Component naming: PascalCase
- File naming: PascalCase for components, camelCase for utilities
- No `any` types (use `unknown`)
- Explicit function return types

### Turborepo Configuration

```json
// turbo.json
{
  "pipeline": {
    "build": {
      "dependsOn": ["^build"],
      "outputs": [".next/**", "dist/**"]
    },
    "dev": {
      "cache": false,
      "persistent": true
    },
    "lint": {},
    "type-check": {}
  }
}
```

### Workspace Configuration

```yaml
# pnpm-workspace.yaml
packages:
  - "apps/*"
  - "packages/*"
```

### Environment Variables Template

```bash
# .env.example

# Supabase
NEXT_PUBLIC_SUPABASE_URL=http://89.117.60.144:8001
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here

# A4F Unified API
A4F_API_KEY=ddc-a4f-12e06ff0184f41de8d3de7be4cd2e831
A4F_BASE_URL=https://api.a4f.co/v1

# VPS Services
VPS_MANIM_URL=http://89.117.60.144:5000
VPS_REVIDEO_URL=http://89.117.60.144:5001
VPS_RAG_URL=http://89.117.60.144:8101
VPS_SEARCH_URL=http://89.117.60.144:8102
VPS_ORCHESTRATOR_URL=http://89.117.60.144:8103
VPS_NOTES_URL=http://89.117.60.144:8104

# Application
NODE_ENV=development
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

### Health Check Implementation

```typescript
// apps/web/app/api/health/route.ts
export async function GET() {
  return Response.json({
    status: 'ok',
    timestamp: new Date().toISOString(),
    uptime: process.uptime(),
    version: process.env.npm_package_version || '1.0.0'
  })
}
```

### Previous Story Insights

From **Story 0.11 (Full Stack Local Development)**:
- Node.js 20+ and pnpm installed
- Basic monorepo structure initialized
- Turborepo configuration template available

From **Story 0.12 (Git Repository & CI/CD)**:
- GitHub Actions workflow template created
- Branch protection rules documented
- CI pipeline stages defined (lint, type-check, test, build)

From **Story 0.13 (Environment Variables)**:
- `.env.example` template structure defined
- Environment validation with Zod available
- Secrets management process documented

---

## Testing

**Test File Location:** [Source: docs/architecture/coding-standards.md#testing-standards]
- No automated tests for this story (infrastructure setup)
- Manual verification checklist in Task 11

**Manual Testing Checklist:**
1. **Repository clone test:** Clone repo on different machine, verify setup works
2. **Development server test:** Run `pnpm dev`, verify both apps start
3. **Build test:** Run `pnpm build`, verify no errors
4. **CI test:** Push commit, verify GitHub Actions passes
5. **Health check test:** `curl localhost:3000/api/health` returns 200 OK
6. **Type safety test:** Introduce TypeScript error, verify caught by type-check
7. **Linting test:** Introduce formatting issue, verify caught by ESLint

---

## Definition of Done

- [ ] All acceptance criteria met
- [ ] All tasks completed and checkboxes marked
- [ ] Repository accessible to team members
- [ ] CI pipeline passing on main branch
- [ ] README.md documentation complete
- [ ] Development environment tested on 2+ machines
- [ ] Health check endpoint responding correctly
- [ ] No TypeScript errors (`pnpm type-check` passes)
- [ ] No ESLint errors (`pnpm lint` passes)
- [ ] Production build succeeds (`pnpm build` passes)
- [ ] Story reviewed and approved by Product Owner
- [ ] Code committed to `main` branch

---

## Execution Order

**Position in Epic:** FIRST (Story 1.1)
**Must Complete Before:** Stories 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 1.10

**Parallel Work Possible:** None (all Epic 1 stories depend on this)

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-23 | 1.0 | Initial story creation | Bob (SM Agent) |

---

## Dev Agent Record

### Agent Model Used

**Model:** Claude Opus 4.5 (claude-opus-4-5-20251101)
**Agent:** James (Dev Agent - BMAD Framework)
**Implementation Date:** December 26, 2025

### Debug Log References

No debug log required - infrastructure verification only.

### Completion Notes

All tasks verified as complete:
- Turborepo monorepo structure exists and functional
- Next.js apps (web, admin) configured with TypeScript and Tailwind
- Shared packages created (supabase, ui, config, utils)
- Supabase project connected to VPS (89.117.60.144:54321)
- GitHub repository initialized with CI/CD pipeline
- Environment variables template created (.env.example)
- Health check API endpoint functional
- README.md and development documentation complete

### File List

**Configuration Files:**
- turbo.json - Turborepo pipeline configuration
- pnpm-workspace.yaml - Workspace definition
- package.json - Root package configuration
- .env.example - Environment variables template
- .gitignore - Git ignore rules
- README.md - Project documentation

**Apps:**
- apps/web/package.json - Web app configuration
- apps/web/next.config.js - Next.js configuration
- apps/web/tailwind.config.js - Tailwind CSS configuration
- apps/web/tsconfig.json - TypeScript configuration
- apps/web/src/app/layout.tsx - Root layout
- apps/web/src/app/page.tsx - Landing page
- apps/web/src/app/api/health/route.ts - Health check endpoint
- apps/admin/package.json - Admin app configuration

**Packages:**
- packages/supabase/package.json - Supabase package
- packages/supabase/supabase/migrations/ - Migration folder structure
- packages/ui/package.json - Shared UI package
- packages/config/package.json - Shared config
- packages/utils/package.json - Shared utilities

**CI/CD:**
- .github/workflows/ci.yml - GitHub Actions pipeline

---

## QA Results

_Results from QA Agent review will be recorded here after story completion_
