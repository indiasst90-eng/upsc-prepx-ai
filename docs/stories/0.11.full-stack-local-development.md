# Story 0.11: Local Development Environment - Full Stack Setup

**Epic:** 0 - Infrastructure Prerequisites
**Story Number:** 0.11
**Status:** Draft
**Created:** December 23, 2025
**Sprint:** Sprint 1 (Epic 0 - Infrastructure Setup)

---

## Story

**As a** developer,
**I want** a complete local development environment with all tools and dependencies,
**so that** I can develop features without manual setup steps.

---

## Acceptance Criteria

1. Node.js 20+ installed and verified: `node -v` returns 20.x.x
2. pnpm installed: `pnpm -v` returns latest version
3. Turborepo installed: `turbo -v` returns latest version
4. Next.js project initialized: `npx create-turbo@latest` creates monorepo structure
5. Directory structure created: `apps/web`, `apps/admin`, `packages/supabase`, `packages/ui`, etc.
6. TypeScript configured: `tsconfig.json` in all packages
7. Tailwind CSS configured: `tailwind.config.ts` with custom theme
8. ESLint + Prettier configured: `npm run lint` passes, code auto-formats
9. Supabase client package created: `@upsc-ai/supabase` with types and utilities
10. Development server runs: `pnpm dev` starts all apps successfully

---

## Tasks / Subtasks

- [ ] **Task 1: Install Node.js 20+** (AC: 1)
  - [ ] Check current version: `node -v`
  - [ ] If <20, install Node.js 20 LTS from nodejs.org
  - [ ] Verify installation: `node -v` shows 20.x.x
  - [ ] Document version in `docs/development-setup.md`

- [ ] **Task 2: Install pnpm** (AC: 2)
  - [ ] Install pnpm: `npm install -g pnpm`
  - [ ] Verify: `pnpm -v`
  - [ ] Configure pnpm: `pnpm config set store-dir ~/.pnpm-store`
  - [ ] Document version

- [ ] **Task 3: Install Turborepo** (AC: 3)
  - [ ] Install globally: `npm install -g turbo`
  - [ ] Verify: `turbo -v`
  - [ ] Document version

- [ ] **Task 4: Initialize Turborepo Monorepo** (AC: 4)
  - [ ] Create project directory: `mkdir upsc-ai-mentor && cd upsc-ai-mentor`
  - [ ] Initialize Turborepo:
    ```bash
    npx create-turbo@latest
    ```
  - [ ] Select options:
    - Package manager: pnpm
    - Include example apps: No (we'll create custom)
  - [ ] Verify `turbo.json` created
  - [ ] Verify `package.json` created with workspaces

- [ ] **Task 5: Create Directory Structure** (AC: 5)
  - [ ] Create apps:
    ```bash
    mkdir -p apps/web apps/admin
    ```
  - [ ] Create packages:
    ```bash
    mkdir -p packages/supabase packages/ui packages/config packages/utils packages/a4f
    ```
  - [ ] Initialize each app:
    ```bash
    cd apps/web && npx create-next-app@latest . --typescript --tailwind --app --src-dir
    cd apps/admin && npx create-next-app@latest . --typescript --tailwind --app --src-dir
    ```
  - [ ] Verify structure matches architecture spec:
    ```
    upsc-ai-mentor/
    ├── apps/
    │   ├── web/
    │   └── admin/
    ├── packages/
    │   ├── supabase/
    │   ├── ui/
    │   ├── config/
    │   ├── utils/
    │   └── a4f/
    ```

- [ ] **Task 6: Configure TypeScript** (AC: 6)
  - [ ] Create root `tsconfig.json`:
    ```json
    {
      "compilerOptions": {
        "target": "ES2022",
        "lib": ["ES2022", "DOM", "DOM.Iterable"],
        "module": "ESNext",
        "moduleResolution": "bundler",
        "strict": true,
        "esModuleInterop": true,
        "skipLibCheck": true,
        "forceConsistentCasingInFileNames": true,
        "resolveJsonModule": true,
        "isolatedModules": true,
        "incremental": true,
        "paths": {
          "@/*": ["./src/*"]
        }
      }
    }
    ```
  - [ ] Create `tsconfig.json` in each app/package extending root
  - [ ] Verify: `pnpm tsc --noEmit` passes

- [ ] **Task 7: Configure Tailwind CSS** (AC: 7)
  - [ ] Install Tailwind in root:
    ```bash
    pnpm add -D tailwindcss postcss autoprefixer
    ```
  - [ ] Create `packages/config/tailwind.config.ts`:
    ```typescript
    import type { Config } from 'tailwindcss';

    const config: Config = {
      darkMode: 'class',
      content: [
        './apps/*/src/**/*.{js,ts,jsx,tsx,mdx}',
        './packages/ui/**/*.{js,ts,jsx,tsx,mdx}'
      ],
      theme: {
        extend: {
          colors: {
            glass: {
              light: 'rgba(255, 255, 255, 0.1)',
              medium: 'rgba(255, 255, 255, 0.15)',
              heavy: 'rgba(255, 255, 255, 0.2)'
            },
            neon: {
              primary: '#00D9FF',
              secondary: '#7B2FFF',
              accent: '#FF006B'
            }
          },
          backdropBlur: {
            glass: '24px'
          }
        }
      },
      plugins: [require('@tailwindcss/typography')]
    };

    export default config;
    ```
  - [ ] Import in app `tailwind.config.ts` files
  - [ ] Verify Tailwind classes work in components

- [ ] **Task 8: Configure ESLint + Prettier** (AC: 8)
  - [ ] Install ESLint:
    ```bash
    pnpm add -D eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin
    ```
  - [ ] Create `.eslintrc.js` in root
  - [ ] Install Prettier:
    ```bash
    pnpm add -D prettier eslint-config-prettier
    ```
  - [ ] Create `.prettierrc`:
    ```json
    {
      "semi": true,
      "trailingComma": "es5",
      "singleQuote": true,
      "tabWidth": 2,
      "printWidth": 100
    }
    ```
  - [ ] Add scripts to root `package.json`:
    ```json
    {
      "scripts": {
        "lint": "turbo run lint",
        "format": "prettier --write \"**/*.{ts,tsx,md}\""
      }
    }
    ```
  - [ ] Run `pnpm lint` - verify passes
  - [ ] Run `pnpm format` - verify auto-formats

- [ ] **Task 9: Create Supabase Client Package** (AC: 9)
  - [ ] Create `packages/supabase/package.json`
  - [ ] Install dependencies:
    ```bash
    cd packages/supabase
    pnpm add @supabase/supabase-js
    pnpm add -D typescript
    ```
  - [ ] Create `packages/supabase/src/client.ts`:
    ```typescript
    import { createClient } from '@supabase/supabase-js';
    import type { Database } from './types';

    export const supabase = createClient<Database>(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
    );

    export const supabaseAdmin = createClient<Database>(
      process.env.SUPABASE_URL!,
      process.env.SUPABASE_SERVICE_ROLE_KEY!
    );
    ```
  - [ ] Create `packages/supabase/src/types.ts` (placeholder for generated types)
  - [ ] Export from `packages/supabase/index.ts`
  - [ ] Test import in apps/web

- [ ] **Task 10: Test Development Server** (AC: 10)
  - [ ] Update root `package.json`:
    ```json
    {
      "scripts": {
        "dev": "turbo run dev",
        "build": "turbo run build",
        "test": "turbo run test"
      }
    }
    ```
  - [ ] Run: `pnpm dev`
  - [ ] Verify apps/web starts on http://localhost:3000
  - [ ] Verify apps/admin starts on http://localhost:3001
  - [ ] Check for compilation errors
  - [ ] Test hot reload (edit file, verify auto-refresh)

- [ ] **Task 11: Update Documentation** (All ACs)
  - [ ] Create `docs/development-setup.md`:
    - Prerequisites (Node 20, pnpm)
    - Installation steps
    - Running dev server
    - Common issues
  - [ ] Update README.md with setup instructions
  - [ ] Commit all changes

---

## Dev Notes

**Purpose:** This story creates the complete local development environment - the Turborepo monorepo with Next.js apps, shared packages, and all tooling configured. This is the foundation for all feature development.

**Risk:** HIGH - Blocks all frontend development

**Dependencies:** Story 0.2 ✅ (Supabase credentials needed)

**Blocks:** All Epic 1+ feature development

---

### Architecture Context

[Source: docs/architecture.md#3, #9, #11]

#### **Tech Stack**

- Node.js: 20+ LTS
- Package Manager: pnpm (faster than npm/yarn)
- Monorepo: Turborepo 2.0+
- Frontend: Next.js 14.2+ (App Router)
- Language: TypeScript 5.3+
- CSS: Tailwind CSS 3.4+
- UI Components: shadcn/ui
- State: Zustand 4.5+
- Linting: ESLint + Prettier

#### **Project Structure** [Source: docs/architecture.md#11]

```
upsc-ai-mentor/
├── apps/
│   ├── web/           # Student app (port 3000)
│   └── admin/         # Admin app (port 3001)
├── packages/
│   ├── supabase/      # Edge Functions, DB types
│   ├── ui/            # shadcn/ui components
│   ├── config/        # Shared configs
│   ├── utils/         # Utilities
│   └── a4f/           # A4F API client
├── docs/              # Documentation
├── turbo.json         # Turborepo config
└── package.json       # Root package with workspaces
```

#### **Development Workflow** [Source: docs/architecture.md#12]

**Commands:**
```bash
# Install dependencies
pnpm install

# Start dev servers
pnpm dev

# Build all apps
pnpm build

# Run tests
pnpm test

# Lint code
pnpm lint
```

---

### Testing

**No automated tests for this story** - manual validation only

**Validation Checklist:**
- [ ] `pnpm dev` starts without errors
- [ ] Both apps accessible in browser
- [ ] TypeScript compilation works
- [ ] Tailwind classes apply correctly
- [ ] ESLint catches errors
- [ ] Prettier formats code

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-23 | 1.0 | Initial story draft | Bob (SM Agent) |

---

## Dev Agent Record

_(To be filled by Dev Agent)_

---

## QA Results

_(To be filled by QA Agent)_

---

**Story Status:** Draft
**Risk Level:** HIGH
**Estimated Effort:** 8-10 hours
**Dependencies:** Story 0.2 ✅ (for Supabase credentials)
**Blocks:** All feature development (Epic 1+)
