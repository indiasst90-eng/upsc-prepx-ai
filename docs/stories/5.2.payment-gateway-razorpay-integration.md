# Story 5.2: Payment Gateway Integration - Razorpay

**Epic:** 5 - Monetization & Subscription System
**Story Number:** 5.2
**Status:** Draft
**Created:** December 23, 2025
**Sprint:** Sprint 6
**Estimated Effort:** Large (L)
**Risk Level:** HIGH (Payments critical)

---

## Story

**As a** UPSC aspirant,
**I want** to subscribe to Pro plans using UPI, cards, or net banking through a secure payment gateway,
**so that** I can unlock premium features with confidence.

---

## Acceptance Criteria

1. Razorpay account created: API keys obtained (test and live)
2. Razorpay Checkout integrated: razorpay-web-sdk for payment modal
3. Payment flow: select plan → Subscribe → Razorpay modal → payment → subscription activated
4. Subscription plans in Razorpay: Monthly, Quarterly, Half-Yearly, Annual with auto-debit
5. Payment webhook: POST /api/webhooks/razorpay verifies signature, creates subscription
6. Transaction logging: all payments to payment_transactions table
7. Failed payment handling: error message, log, email retry link
8. PCI compliance: no card data stored
9. Invoice generation: PDF with company details, txn ID, amount, GST
10. Test payments: use Razorpay test cards for QA

---

## Dependencies

**Blocking:** Stories 5.1, 1.3
**Blocks:** Stories 5.3, 5.5

---

## Definition of Done

- [ ] All AC met
- [ ] Razorpay integrated
- [ ] All payment methods working
- [ ] Webhooks functional
- [ ] Invoices generated
- [ ] Test payments verified

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-23 | 1.0 | Initial story creation | Bob (SM Agent) |
