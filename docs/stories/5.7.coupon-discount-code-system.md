# Story 5.7: Coupon & Discount Code System

**Epic:** 5 - Monetization & Subscription System
**Story Number:** 5.7
**Status:** Draft
**Created:** December 23, 2025
**Sprint:** Sprint 6
**Estimated Effort:** Medium (M)
**Risk Level:** LOW

---

## Story

**As a** marketing manager,
**I want** to create and manage discount coupons for promotional campaigns,
**so that** I can drive conversions through targeted offers.

---

## Acceptance Criteria

1. Admin coupon management: /admin/coupons with create/edit/deactivate
2. Coupon fields: code (unique), discount_type (percent/fixed), discount_value, valid_from, valid_until, max_uses, used_count
3. Restrictions: min_plan (e.g., only Annual), first_purchase_only, per_user_limit
4. Coupon input: checkout page has "Apply Coupon" field
5. Validation: check code exists, not expired, uses not exceeded, restrictions met
6. Price calculation: discount applied, final price displayed before payment
7. Applied coupon tracked: payment_transactions.coupon_code saved
8. Usage increment: coupon.used_count incremented on successful payment
9. User-specific coupons: email-locked coupons (only for specific user)
10. Analytics: track redemption rate, revenue per coupon

---

## Dependencies

**Blocking:** Stories 5.2, 1.3
**Blocks:** None

---

## Definition of Done

- [ ] All AC met
- [ ] Admin can create coupons
- [ ] Users can apply coupons
- [ ] Validation working
- [ ] Tracking functional
- [ ] Analytics showing usage

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-23 | 1.0 | Initial story creation | Bob (SM Agent) |
