# Story 10.1: Documentary Script Generator - Long-Form Content

**Epic:** 10 - Deep Learning Assets - Documentary Lectures & Weekly Analysis
**Story Number:** 10.1
**Status:** COMPLETE
**Created:** December 23, 2025
**Sprint:** Sprint 10 (Epic 10)
**Estimated Effort:** Large (L)
**Risk Level:** HIGH

---

## Story

**As a** content producer,
**I want** to generate 3-hour documentary-style lecture scripts from topic content,
**so that** I can create comprehensive long-form educational videos for deep conceptual understanding.

---

## Acceptance Criteria

1. Edge Function: `generate_documentary_script_pipe.ts` at `POST /api/documentary/generate`
2. Topic input: single topic or chapter (e.g., "Modern Indian History - 1857-1947")
3. Target duration: 2-3 hours (15,000-20,000 words of content)
4. Script structure:
   - Introduction (10 min): topic overview, importance, learning objectives
   - Chapters (8-10): chronological or thematic breakdown with 15-20 min each
   - Conclusion (5 min): key takeaways, exam relevance, next steps
5. Content sourced: RAG retrieval of 10-20 relevant knowledge chunks
6. Script includes: narration, visual markers ([DIAGRAM], [TIMELINE], [MAP], [INTERVIEW_CLIP]), chapter markers
7. Voice-over style: documentary narration with pauses for visuals
8. Multiple voices: occasionally switch between "narrator" and "expert" perspectives
9. Chapter scripts saved: `documentary_scripts` table with status = 'pending_visuals'
10. Quality check: LLM reviews script for coherence, flow, UPSC relevance

---

## Dependencies

**Blocking:** Stories 1.7, 2.3 (RAG search, notes synthesis)
**Blocks:** Stories 10.2, 10.3

---

## Definition of Done

- [x] All AC met
- [x] Script coherent and exam-focused
- [x] Chapter markers properly placed
- [x] Tests passing
- [x] Documentation updated

---

## Implementation Summary

### Database (Migration 053)
- `documentary_scripts` table for storing generated scripts
- `documentary_chapters` table for individual chapters
- Functions: create_documentary_script, add_documentary_chapter, finalize_documentary_script
- Functions: review_documentary_script, get_documentary_script, get_user_documentary_scripts
- RLS policies for user access control

### API Endpoint (`/api/documentary`)
- POST: Generate documentary script with actions (generate, review)
- GET: List user scripts or fetch single script
- RAG integration via VPS_RAG_URL for content sourcing
- AI generation via A4F API for script creation
- Quality check function with coherence, flow, UPSC relevance scoring

### UI Page (`/documentary`)
- Topic input with category selection (AC 2)
- Duration options: 2h, 2.5h, 3h (AC 3)
- Voice style selection: documentary, academic, conversational (AC 7)
- Script list with status badges
- Script viewer with chapters, visual markers, quality feedback
- Introduction with learning objectives display
- Conclusion with key takeaways and exam relevance

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-23 | 1.0 | Initial story creation | Bob (SM Agent) |
| 2025-12-28 | 2.0 | Implementation complete - all 10 ACs met | Dev Agent |

---

**Story Status:** COMPLETE
**Risk Level:** HIGH
**Estimated Effort:** Large (L)
