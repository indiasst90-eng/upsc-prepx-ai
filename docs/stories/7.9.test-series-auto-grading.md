# Story 7.9: Test Series - Auto-Grading & Results

**Epic:** 7 - Practice & Evaluation - Answer Writing & Essays
**Story Number:** 7.9
**Status:** Draft
**Created:** December 23, 2025
**Sprint:** Sprint 8 (Epic 7)
**Estimated Effort:** Large (L)
**Risk Level:** MEDIUM

---

## Story

**As a** UPSC aspirant,
**I want** instant grading and detailed results after completing a test,
**so that** I can analyze my performance immediately without waiting.

---

## Acceptance Criteria

1. Prelims auto-grading: instantly grades MCQs by comparing with answer key, calculates score with negative marking (-0.33)
2. Mains auto-grading: uses answer evaluation engine (Story 7.2) to grade each Mains answer within 5 minutes
3. Edge Function: `grade_test_pipe.ts` orchestrates grading pipeline
4. Results page: /tests/results/{attempt_id} shows overall score, subject-wise breakdown, time analysis
5. Answer review: displays all questions with user's answer, correct answer, explanation
6. Performance metrics: accuracy %, time per question, strong/weak topics
7. Percentile calculation: compares user's score with all users who took same test
8. Database: updates `test_attempts` with score, subject_scores_json, percentile, graded_at
9. Certificate: generates participation certificate for completed tests (downloadable PDF)
10. Notification: sends email summary "Your test results are ready" with score highlights

---

## Dependencies

**Blocking:** Stories 7.8, 7.2 (test platform, answer evaluation)
**Blocks:** Story 7.10

---

## Definition of Done

- [ ] All AC met
- [ ] Grading accurate and fast
- [ ] Results page comprehensive
- [ ] Percentile calculated correctly
- [ ] Tests passing

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-23 | 1.0 | Initial story creation | Bob (SM Agent) |
